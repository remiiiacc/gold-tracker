<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Central Bank Gold Reserves Tracker</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <style>
        :root {
            --gold-primary: #D4AF37;
            --gold-light: #F4E4BA;
            --gold-dark: #996515;
            --bg-dark: #0D0D0D;
            --bg-card: #1A1A1A;
            --bg-card-hover: #242424;
            --text-primary: #FAFAFA;
            --text-secondary: #A0A0A0;
            --text-muted: #666666;
            --border-color: #2A2A2A;
            --positive: #22C55E;
            --negative: #EF4444;
            --accent-blue: #3B82F6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'DM Sans', -apple-system, sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--bg-card) 0%, #1F1F1F 100%);
            border-bottom: 1px solid var(--border-color);
            padding: 24px 48px;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .header-content {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--gold-primary) 0%, var(--gold-dark) 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 4px 20px rgba(212, 175, 55, 0.3);
        }

        .logo-text h1 {
            font-size: 20px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .logo-text span {
            font-size: 12px;
            color: var(--text-secondary);
            font-family: 'Space Mono', monospace;
        }

        .header-actions {
            display: flex;
            gap: 12px;
        }

        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            font-family: inherit;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--gold-primary) 0%, var(--gold-dark) 100%);
            color: #000;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(212, 175, 55, 0.4);
        }

        .btn-secondary {
            background: var(--bg-card);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--bg-card-hover);
            border-color: var(--gold-primary);
        }

        /* Main Layout */
        .main {
            max-width: 1600px;
            margin: 0 auto;
            padding: 32px 48px;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 24px;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            border-color: var(--gold-primary);
            transform: translateY(-4px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .stat-label {
            font-size: 13px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
            font-family: 'Space Mono', monospace;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--gold-primary);
            margin-bottom: 4px;
        }

        .stat-change {
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .stat-change.positive {
            color: var(--positive);
        }

        .stat-change.negative {
            color: var(--negative);
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 16px;
        }

        .tab {
            padding: 12px 24px;
            background: transparent;
            border: 1px solid transparent;
            border-radius: 8px;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
            font-family: inherit;
        }

        .tab:hover {
            color: var(--text-primary);
            background: var(--bg-card);
        }

        .tab.active {
            background: var(--bg-card);
            color: var(--gold-primary);
            border-color: var(--gold-primary);
        }

        /* Content Sections */
        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        /* Charts Grid */
        .charts-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 24px;
            margin-bottom: 32px;
        }

        .chart-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 24px;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 18px;
            font-weight: 600;
        }

        .chart-subtitle {
            font-size: 13px;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        .time-filters {
            display: flex;
            gap: 4px;
        }

        .time-filter {
            padding: 6px 12px;
            background: transparent;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 12px;
            font-family: 'Space Mono', monospace;
            transition: all 0.2s ease;
        }

        .time-filter:hover,
        .time-filter.active {
            background: var(--gold-primary);
            color: #000;
            border-color: var(--gold-primary);
        }

        .chart-container {
            height: 350px;
            position: relative;
        }

        /* Data Table */
        .table-container {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            overflow: hidden;
        }

        .table-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .table-title {
            font-size: 18px;
            font-weight: 600;
        }

        .search-box {
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--bg-dark);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 8px 16px;
        }

        .search-box input {
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-size: 14px;
            width: 200px;
            outline: none;
            font-family: inherit;
        }

        .search-box input::placeholder {
            color: var(--text-muted);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 16px 24px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        th {
            background: var(--bg-dark);
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-family: 'Space Mono', monospace;
        }

        td {
            font-size: 14px;
        }

        tr:hover td {
            background: var(--bg-card-hover);
        }

        .country-cell {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .country-flag {
            width: 32px;
            height: 24px;
            border-radius: 4px;
            background: var(--bg-dark);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .tonnes {
            font-weight: 600;
            color: var(--gold-primary);
            font-family: 'Space Mono', monospace;
        }

        .change-positive {
            color: var(--positive);
            font-family: 'Space Mono', monospace;
        }

        .change-negative {
            color: var(--negative);
            font-family: 'Space Mono', monospace;
        }

        /* Sources Section */
        .sources-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 32px;
        }

        .source-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 24px;
            transition: all 0.3s ease;
        }

        .source-card:hover {
            border-color: var(--gold-primary);
        }

        .source-icon {
            width: 48px;
            height: 48px;
            background: var(--bg-dark);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 16px;
        }

        .source-name {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .source-desc {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 16px;
            line-height: 1.5;
        }

        .source-meta {
            display: flex;
            gap: 16px;
            font-size: 12px;
            color: var(--text-muted);
            font-family: 'Space Mono', monospace;
        }

        .source-link {
            display: inline-block;
            margin-top: 16px;
            padding: 8px 16px;
            background: var(--bg-dark);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--gold-primary);
            text-decoration: none;
            font-size: 13px;
            transition: all 0.2s ease;
        }

        .source-link:hover {
            background: var(--gold-primary);
            color: #000;
        }

        /* Upload Section */
        .upload-section {
            background: var(--bg-card);
            border: 2px dashed var(--border-color);
            border-radius: 16px;
            padding: 48px;
            text-align: center;
            margin-bottom: 32px;
            transition: all 0.3s ease;
        }

        .upload-section:hover,
        .upload-section.dragover {
            border-color: var(--gold-primary);
            background: rgba(212, 175, 55, 0.05);
        }

        .upload-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .upload-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .upload-desc {
            color: var(--text-secondary);
            margin-bottom: 24px;
        }

        .upload-input {
            display: none;
        }

        /* Historical Data Section */
        .historical-controls {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .control-label {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-family: 'Space Mono', monospace;
        }

        select {
            padding: 10px 16px;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 14px;
            font-family: inherit;
            cursor: pointer;
            min-width: 180px;
        }

        select:focus {
            outline: none;
            border-color: var(--gold-primary);
        }

        /* Loading State */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 48px;
            color: var(--text-secondary);
        }

        .spinner {
            width: 32px;
            height: 32px;
            border: 3px solid var(--border-color);
            border-top-color: var(--gold-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 16px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Status Badge */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-family: 'Space Mono', monospace;
        }

        .status-badge.live {
            background: rgba(34, 197, 94, 0.1);
            color: var(--positive);
        }

        .status-badge.live::before {
            content: '';
            width: 8px;
            height: 8px;
            background: var(--positive);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Footer */
        .footer {
            border-top: 1px solid var(--border-color);
            padding: 24px 48px;
            margin-top: 48px;
        }

        .footer-content {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--text-muted);
            font-size: 13px;
        }

        .footer-links {
            display: flex;
            gap: 24px;
        }

        .footer-links a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.2s ease;
        }

        .footer-links a:hover {
            color: var(--gold-primary);
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .charts-grid {
                grid-template-columns: 1fr;
            }
            .sources-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .header {
                padding: 16px 24px;
            }
            .main {
                padding: 24px;
            }
            .stats-grid {
                grid-template-columns: 1fr;
            }
            .sources-grid {
                grid-template-columns: 1fr;
            }
            .header-content {
                flex-direction: column;
                gap: 16px;
            }
        }

        /* Notification Toast */
        .toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 16px 24px;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        .toast.success {
            border-color: var(--positive);
        }

        .toast.error {
            border-color: var(--negative);
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">üè¶</div>
                <div class="logo-text">
                    <h1>Central Bank Gold Tracker</h1>
                    <span>RESERVES MONITORING DASHBOARD</span>
                </div>
            </div>
            <div class="header-actions">
                <span class="status-badge live">LIVE DATA</span>
                <button class="btn btn-secondary" onclick="refreshData()">‚Üª Refresh</button>
                <button class="btn btn-primary" onclick="exportData()">‚Üì Export CSV</button>
            </div>
        </div>
    </header>

    <main class="main">
        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">Global CB Holdings</div>
                <div class="stat-value" id="totalHoldings">36,359</div>
                <div class="stat-change positive" id="holdingsChange">
                    <span>‚ñ≤</span> +809t YTD (Q3 2025)
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Net Purchases (2025 YTD)</div>
                <div class="stat-value" id="netPurchases">~850t</div>
                <div class="stat-change positive">
                    <span>‚ñ≤</span> 4th consecutive year >800t
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Top Buyer (2025)</div>
                <div class="stat-value" id="topBuyer">Poland</div>
                <div class="stat-change positive">
                    <span>‚ñ≤</span> +67t (through Q3)
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Last Updated</div>
                <div class="stat-value" id="lastUpdated" style="font-size: 24px;">‚Äî</div>
                <div class="stat-change">
                    <span>IMF IFS + WGC Q3 2025</span>
                </div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab active" data-tab="overview">Overview</button>
            <button class="tab" data-tab="historical">Historical (40Y)</button>
            <button class="tab" data-tab="countries">By Country</button>
            <button class="tab" data-tab="sources">Data Sources</button>
            <button class="tab" data-tab="upload">Upload Data</button>
        </div>

        <!-- Overview Section -->
        <section class="content-section active" id="overview">
            <div class="charts-grid">
                <div class="chart-card">
                    <div class="chart-header">
                        <div>
                            <div class="chart-title">Annual Central Bank Net Purchases</div>
                            <div class="chart-subtitle">Tonnes per year (Source: World Gold Council)</div>
                        </div>
                        <div class="time-filters">
                            <button class="time-filter" data-years="10">10Y</button>
                            <button class="time-filter active" data-years="20">20Y</button>
                            <button class="time-filter" data-years="40">40Y</button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="annualPurchasesChart"></canvas>
                    </div>
                </div>
                <div class="chart-card">
                    <div class="chart-header">
                        <div>
                            <div class="chart-title">Top Buyers (2025 YTD)</div>
                            <div class="chart-subtitle">Net purchases in tonnes (through Q3)</div>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="topBuyersChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="chart-card">
                <div class="chart-header">
                    <div>
                        <div class="chart-title">Cumulative Central Bank Holdings</div>
                        <div class="chart-subtitle">Total tonnes held by central banks globally</div>
                    </div>
                </div>
                <div class="chart-container" style="height: 300px;">
                    <canvas id="cumulativeChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Historical Section -->
        <section class="content-section" id="historical">
            <div class="historical-controls">
                <div class="control-group">
                    <label class="control-label">Time Period</label>
                    <select id="historicalPeriod" onchange="updateHistoricalChart()">
                        <option value="5">Last 5 Years</option>
                        <option value="10">Last 10 Years</option>
                        <option value="20">Last 20 Years</option>
                        <option value="40" selected>Last 40 Years</option>
                    </select>
                </div>
                <div class="control-group">
                    <label class="control-label">View</label>
                    <select id="historicalView" onchange="updateHistoricalChart()">
                        <option value="annual">Annual Net Purchases</option>
                        <option value="cumulative">Cumulative Holdings</option>
                    </select>
                </div>
                <div class="control-group">
                    <label class="control-label">Country Filter</label>
                    <select id="countryFilter" onchange="updateHistoricalChart()">
                        <option value="all">All Central Banks</option>
                        <option value="developed">Developed Markets</option>
                        <option value="emerging">Emerging Markets</option>
                    </select>
                </div>
            </div>

            <div class="chart-card">
                <div class="chart-header">
                    <div>
                        <div class="chart-title">Historical Central Bank Gold Activity (1985-2025)</div>
                        <div class="chart-subtitle">41 years of data from World Gold Council</div>
                    </div>
                </div>
                <div class="chart-container" style="height: 450px;">
                    <canvas id="historicalChart"></canvas>
                </div>
            </div>

            <div class="table-container" style="margin-top: 24px;">
                <div class="table-header">
                    <div class="table-title">Annual Data Table</div>
                    <button class="btn btn-secondary" onclick="exportHistorical()">‚Üì Export</button>
                </div>
                <div style="max-height: 400px; overflow-y: auto;">
                    <table id="historicalTable">
                        <thead>
                            <tr>
                                <th>Year</th>
                                <th>Net Purchases (t)</th>
                                <th>Total Holdings (t)</th>
                                <th>YoY Change</th>
                                <th>Gold Price (Avg)</th>
                            </tr>
                        </thead>
                        <tbody id="historicalTableBody"></tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Countries Section -->
        <section class="content-section" id="countries">
            <div class="table-container">
                <div class="table-header">
                    <div class="table-title">Central Bank Holdings by Country</div>
                    <div class="search-box">
                        <span>üîç</span>
                        <input type="text" placeholder="Search country..." id="countrySearch" oninput="filterCountries()">
                    </div>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Country</th>
                            <th>Holdings (Tonnes)</th>
                            <th>% of Reserves</th>
                            <th>2025 Change</th>
                            <th>Last Reported</th>
                        </tr>
                    </thead>
                    <tbody id="countriesTableBody"></tbody>
                </table>
            </div>
        </section>

        <!-- Sources Section -->
        <section class="content-section" id="sources">
            <div class="sources-grid">
                <div class="source-card">
                    <div class="source-icon">üåê</div>
                    <div class="source-name">World Gold Council</div>
                    <div class="source-desc">Primary source for quarterly central bank gold demand reports. Provides comprehensive data on purchases, sales, and holdings.</div>
                    <div class="source-meta">
                        <span>üìÖ Quarterly</span>
                        <span>üìä Best for trends</span>
                    </div>
                    <a href="https://www.gold.org/goldhub/data/gold-demand-trends" target="_blank" class="source-link">Visit Goldhub ‚Üí</a>
                </div>
                <div class="source-card">
                    <div class="source-icon">üèõÔ∏è</div>
                    <div class="source-name">IMF IFS Database</div>
                    <div class="source-desc">Official reserve data reported by IMF member countries. Monthly updates but may lag actual purchases. Some countries underreport.</div>
                    <div class="source-meta">
                        <span>üìÖ Monthly</span>
                        <span>üìä Official only</span>
                    </div>
                    <a href="https://data.imf.org/regular.aspx?key=61545855" target="_blank" class="source-link">Visit IMF Data ‚Üí</a>
                </div>
                <div class="source-card">
                    <div class="source-icon">üìà</div>
                    <div class="source-name">Metals Focus</div>
                    <div class="source-desc">Professional-grade precious metals data. Includes unreported/estimated purchases. Requires paid subscription.</div>
                    <div class="source-meta">
                        <span>üìÖ Monthly</span>
                        <span>üí∞ Paid</span>
                    </div>
                    <a href="https://www.metalsfocus.com/" target="_blank" class="source-link">Visit Site ‚Üí</a>
                </div>
                <div class="source-card">
                    <div class="source-icon">üìä</div>
                    <div class="source-name">GFMS / Refinitiv</div>
                    <div class="source-desc">Historical supply/demand data since 1970s. Now part of LSEG. Industry standard for research.</div>
                    <div class="source-meta">
                        <span>üìÖ Quarterly</span>
                        <span>üí∞ Paid</span>
                    </div>
                    <a href="https://www.lseg.com/en/data-analytics" target="_blank" class="source-link">Visit LSEG ‚Üí</a>
                </div>
                <div class="source-card">
                    <div class="source-icon">üá∫üá∏</div>
                    <div class="source-name">US Treasury / Fed</div>
                    <div class="source-desc">US gold reserves data. Updated monthly. The US holds 8,133t, the world's largest official holding.</div>
                    <div class="source-meta">
                        <span>üìÖ Monthly</span>
                        <span>üìä US Only</span>
                    </div>
                    <a href="https://fiscaldata.treasury.gov/" target="_blank" class="source-link">Visit Treasury ‚Üí</a>
                </div>
                <div class="source-card">
                    <div class="source-icon">üá®üá≥</div>
                    <div class="source-name">PBoC / SAFE</div>
                    <div class="source-desc">China's official gold reserves. Reported monthly but suspected to be understated. Watch for sporadic large increases.</div>
                    <div class="source-meta">
                        <span>üìÖ Monthly</span>
                        <span>‚ö†Ô∏è May underreport</span>
                    </div>
                    <a href="http://www.pbc.gov.cn/en/3688006/index.html" target="_blank" class="source-link">Visit PBoC ‚Üí</a>
                </div>
            </div>

            <div class="chart-card">
                <div class="chart-title" style="margin-bottom: 16px;">Data Collection Schedule</div>
                <table>
                    <thead>
                        <tr>
                            <th>Source</th>
                            <th>Update Frequency</th>
                            <th>Typical Lag</th>
                            <th>Next Expected</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>WGC Gold Demand Trends</td>
                            <td>Quarterly</td>
                            <td>6-8 weeks</td>
                            <td>Feb 2026 (Q4 2025)</td>
                            <td><a href="https://www.gold.org/goldhub/research/gold-demand-trends" target="_blank" style="color: var(--gold-primary);">Check ‚Üí</a></td>
                        </tr>
                        <tr>
                            <td>IMF IFS</td>
                            <td>Monthly</td>
                            <td>1-2 months</td>
                            <td>Jan 2026 (Nov 2025)</td>
                            <td><a href="https://data.imf.org" target="_blank" style="color: var(--gold-primary);">Check ‚Üí</a></td>
                        </tr>
                        <tr>
                            <td>Trading Economics</td>
                            <td>Monthly</td>
                            <td>1 month</td>
                            <td>Rolling</td>
                            <td><a href="https://tradingeconomics.com/country-list/gold-reserves" target="_blank" style="color: var(--gold-primary);">Check ‚Üí</a></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Upload Section -->
        <section class="content-section" id="upload">
            <div class="upload-section" id="dropZone">
                <div class="upload-icon">üì§</div>
                <div class="upload-title">Upload WGC or IMF Data</div>
                <div class="upload-desc">Drag and drop Excel/CSV files from World Gold Council or IMF<br>to update the dashboard with latest data</div>
                <input type="file" class="upload-input" id="fileInput" accept=".csv,.xlsx,.xls" onchange="handleFileUpload(event)">
                <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">Choose File</button>
            </div>

            <div class="chart-card">
                <div class="chart-title" style="margin-bottom: 16px;">Manual Data Entry</div>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">Add individual country updates manually:</p>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 20px;">
                    <div class="control-group">
                        <label class="control-label">Country</label>
                        <select id="manualCountry">
                            <option value="">Select country</option>
                            <option value="CN">China</option>
                            <option value="RU">Russia</option>
                            <option value="IN">India</option>
                            <option value="TR">Turkey</option>
                            <option value="PL">Poland</option>
                            <option value="other">Other...</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label class="control-label">Month/Year</label>
                        <input type="month" id="manualDate" style="padding: 10px 16px; background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px; color: var(--text-primary); font-family: inherit;">
                    </div>
                    <div class="control-group">
                        <label class="control-label">Holdings (Tonnes)</label>
                        <input type="number" id="manualHoldings" placeholder="e.g., 2264.3" style="padding: 10px 16px; background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px; color: var(--text-primary); font-family: inherit;">
                    </div>
                    <div class="control-group">
                        <label class="control-label">&nbsp;</label>
                        <button class="btn btn-primary" onclick="addManualEntry()">Add Entry</button>
                    </div>
                </div>
            </div>

            <div class="chart-card" style="margin-top: 24px;">
                <div class="chart-title" style="margin-bottom: 16px;">Recent Uploads</div>
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Source</th>
                            <th>Records</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="uploadsTableBody">
                        <tr>
                            <td colspan="4" style="text-align: center; color: var(--text-muted); padding: 32px;">No uploads yet</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="footer-content">
            <div>¬© 2025 Central Bank Gold Tracker. Data sourced from WGC, IMF, and central bank disclosures.</div>
            <div class="footer-links">
                <a href="https://www.gold.org/goldhub" target="_blank">WGC Goldhub</a>
                <a href="https://data.imf.org" target="_blank">IMF Data</a>
                <a href="#">API Docs</a>
            </div>
        </div>
    </footer>

    <div class="toast" id="toast">
        <span id="toastMessage"></span>
    </div>

    <script>
        // ===========================================
        // HISTORICAL DATA (1985-2024)
        // Source: World Gold Council
        // ===========================================
        const historicalData = {
            // Annual net purchases by central banks (tonnes)
            // Negative = net sales, Positive = net purchases
            // Sources: World Gold Council Gold Demand Trends reports
            annualNetPurchases: {
                1985: -200, 1986: -250, 1987: -300, 1988: -200, 1989: -250,
                1990: -300, 1991: -150, 1992: -400, 1993: -500, 1994: -300,
                1995: -200, 1996: -350, 1997: -400, 1998: -350, 1999: -477,
                2000: -479, 2001: -520, 2002: -545, 2003: -620, 2004: -479,
                2005: -663, 2006: -365, 2007: -484, 2008: -235, 2009: -34,
                2010: 77, 2011: 457, 2012: 544, 2013: 409, 2014: 584,
                2015: 577, 2016: 390, 2017: 375, 2018: 656, 2019: 650,
                2020: 255, 2021: 463, 2022: 1082, 2023: 1037, 2024: 1045,
                2025: 850 // Estimated: Q1-Q3 = 634t, Q4 estimated ~216t (WGC data through Oct 2025)
            },
            // Cumulative holdings (approximate, tonnes)
            // Source: IMF IFS, World Gold Council
            totalHoldings: {
                1985: 35800, 1986: 35550, 1987: 35250, 1988: 35050, 1989: 34800,
                1990: 34500, 1991: 34350, 1992: 33950, 1993: 33450, 1994: 33150,
                1995: 32950, 1996: 32600, 1997: 32200, 1998: 31850, 1999: 31373,
                2000: 30894, 2001: 30374, 2002: 29829, 2003: 29209, 2004: 28730,
                2005: 28067, 2006: 27702, 2007: 27218, 2008: 26983, 2009: 26949,
                2010: 27026, 2011: 27483, 2012: 28027, 2013: 28436, 2014: 29020,
                2015: 29597, 2016: 29987, 2017: 30362, 2018: 31018, 2019: 31668,
                2020: 31923, 2021: 32386, 2022: 33468, 2023: 34505, 2024: 35550,
                2025: 36359 // IMF data as of September 2025
            },
            // Average gold price per year (USD/oz)
            goldPrice: {
                1985: 317, 1986: 368, 1987: 447, 1988: 437, 1989: 381,
                1990: 383, 1991: 362, 1992: 343, 1993: 360, 1994: 384,
                1995: 384, 1996: 388, 1997: 331, 1998: 294, 1999: 279,
                2000: 279, 2001: 271, 2002: 310, 2003: 363, 2004: 410,
                2005: 445, 2006: 604, 2007: 695, 2008: 872, 2009: 972,
                2010: 1225, 2011: 1572, 2012: 1669, 2013: 1411, 2014: 1266,
                2015: 1160, 2016: 1251, 2017: 1257, 2018: 1269, 2019: 1393,
                2020: 1770, 2021: 1799, 2022: 1800, 2023: 1943, 2024: 2386,
                2025: 3200 // Estimated average (prices ranged ~$2600-$4400)
            }
        };

        // Top holders data (as of Q3 2025)
        // Source: IMF IFS, World Gold Council
        const topHolders = [
            { rank: 1, country: 'United States', code: 'US', holdings: 8133.5, pctReserves: 72.4, change2025: 0, lastReported: 'Dec 2025' },
            { rank: 2, country: 'Germany', code: 'DE', holdings: 3352.3, pctReserves: 71.5, change2025: 0, lastReported: 'Dec 2025' },
            { rank: 3, country: 'Italy', code: 'IT', holdings: 2451.8, pctReserves: 68.3, change2025: 0, lastReported: 'Dec 2025' },
            { rank: 4, country: 'France', code: 'FR', holdings: 2436.9, pctReserves: 69.8, change2025: 0, lastReported: 'Dec 2025' },
            { rank: 5, country: 'Russia', code: 'RU', holdings: 2340.0, pctReserves: 32.1, change2025: 3, lastReported: 'Dec 2025' },
            { rank: 6, country: 'China', code: 'CN', holdings: 2280.0, pctReserves: 5.8, change2025: 19, lastReported: 'Nov 2025' },
            { rank: 7, country: 'Switzerland', code: 'CH', holdings: 1040.0, pctReserves: 8.4, change2025: 0, lastReported: 'Dec 2025' },
            { rank: 8, country: 'India', code: 'IN', holdings: 876.2, pctReserves: 10.8, change2025: 23, lastReported: 'Dec 2025' },
            { rank: 9, country: 'Japan', code: 'JP', holdings: 846.0, pctReserves: 4.6, change2025: 0, lastReported: 'Dec 2025' },
            { rank: 10, country: 'Netherlands', code: 'NL', holdings: 612.5, pctReserves: 62.4, change2025: 0, lastReported: 'Dec 2025' },
            { rank: 11, country: 'Turkey', code: 'TR', holdings: 615.0, pctReserves: 35.2, change2025: 20, lastReported: 'Dec 2025' },
            { rank: 12, country: 'Poland', code: 'PL', holdings: 515.0, pctReserves: 24.0, change2025: 67, lastReported: 'Dec 2025' },
            { rank: 13, country: 'Taiwan', code: 'TW', holdings: 423.6, pctReserves: 4.4, change2025: 0, lastReported: 'Dec 2025' },
            { rank: 14, country: 'Kazakhstan', code: 'KZ', holdings: 324.0, pctReserves: 56.2, change2025: 40, lastReported: 'Dec 2025' },
            { rank: 15, country: 'Saudi Arabia', code: 'SA', holdings: 323.1, pctReserves: 4.8, change2025: 0, lastReported: 'Dec 2025' },
        ];

        // Top buyers 2025 (through Q3)
        // Source: World Gold Council
        const topBuyers2024 = [
            { country: 'Poland', purchases: 67 },
            { country: 'Kazakhstan', purchases: 40 },
            { country: 'Azerbaijan', purchases: 35 },
            { country: 'India', purchases: 23 },
            { country: 'Turkey', purchases: 20 },
            { country: 'China', purchases: 19 },
            { country: 'Czech Republic', purchases: 12 },
        ];

        // Chart instances
        let annualChart, topBuyersChartInstance, cumulativeChartInstance, historicalChartInstance;

        // ===========================================
        // INITIALIZATION
        // ===========================================
        document.addEventListener('DOMContentLoaded', function() {
            initializeTabs();
            initializeCharts();
            populateCountriesTable();
            populateHistoricalTable();
            updateLastUpdated();
            initializeDragDrop();
        });

        function initializeTabs() {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
                    document.getElementById(tab.dataset.tab).classList.add('active');
                });
            });

            // Time filter buttons
            document.querySelectorAll('.time-filter').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.time-filter').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    updateAnnualChart(parseInt(this.dataset.years));
                });
            });
        }

        function initializeCharts() {
            // Chart.js defaults
            Chart.defaults.color = '#A0A0A0';
            Chart.defaults.borderColor = '#2A2A2A';
            Chart.defaults.font.family = "'DM Sans', sans-serif";

            createAnnualPurchasesChart();
            createTopBuyersChart();
            createCumulativeChart();
            createHistoricalChart();
        }

        // ===========================================
        // CHARTS
        // ===========================================
        function createAnnualPurchasesChart() {
            const ctx = document.getElementById('annualPurchasesChart').getContext('2d');
            const years = Object.keys(historicalData.annualNetPurchases).slice(-20);
            const data = years.map(y => historicalData.annualNetPurchases[y]);

            annualChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: years,
                    datasets: [{
                        label: 'Net Purchases (tonnes)',
                        data: data,
                        backgroundColor: data.map(v => v >= 0 ? 'rgba(212, 175, 55, 0.8)' : 'rgba(239, 68, 68, 0.8)'),
                        borderColor: data.map(v => v >= 0 ? '#D4AF37' : '#EF4444'),
                        borderWidth: 1,
                        borderRadius: 4,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: '#1A1A1A',
                            borderColor: '#2A2A2A',
                            borderWidth: 1,
                            titleColor: '#FAFAFA',
                            bodyColor: '#A0A0A0',
                            callbacks: {
                                label: (ctx) => `${ctx.parsed.y >= 0 ? '+' : ''}${ctx.parsed.y.toLocaleString()}t`
                            }
                        }
                    },
                    scales: {
                        y: {
                            grid: { color: '#2A2A2A' },
                            ticks: {
                                callback: (v) => `${v >= 0 ? '+' : ''}${v}t`
                            }
                        },
                        x: {
                            grid: { display: false }
                        }
                    }
                }
            });
        }

        function updateAnnualChart(years) {
            const allYears = Object.keys(historicalData.annualNetPurchases);
            const selectedYears = allYears.slice(-years);
            const data = selectedYears.map(y => historicalData.annualNetPurchases[y]);

            annualChart.data.labels = selectedYears;
            annualChart.data.datasets[0].data = data;
            annualChart.data.datasets[0].backgroundColor = data.map(v => v >= 0 ? 'rgba(212, 175, 55, 0.8)' : 'rgba(239, 68, 68, 0.8)');
            annualChart.data.datasets[0].borderColor = data.map(v => v >= 0 ? '#D4AF37' : '#EF4444');
            annualChart.update();
        }

        function createTopBuyersChart() {
            const ctx = document.getElementById('topBuyersChart').getContext('2d');
            
            topBuyersChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: topBuyers2024.map(b => b.country),
                    datasets: [{
                        label: 'Purchases (tonnes)',
                        data: topBuyers2024.map(b => b.purchases),
                        backgroundColor: 'rgba(212, 175, 55, 0.8)',
                        borderColor: '#D4AF37',
                        borderWidth: 1,
                        borderRadius: 4,
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: '#1A1A1A',
                            borderColor: '#2A2A2A',
                            borderWidth: 1,
                            callbacks: {
                                label: (ctx) => `+${ctx.parsed.x}t`
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: { color: '#2A2A2A' },
                            ticks: { callback: (v) => `+${v}t` }
                        },
                        y: {
                            grid: { display: false }
                        }
                    }
                }
            });
        }

        function createCumulativeChart() {
            const ctx = document.getElementById('cumulativeChart').getContext('2d');
            const years = Object.keys(historicalData.totalHoldings);
            const data = years.map(y => historicalData.totalHoldings[y]);

            cumulativeChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: years,
                    datasets: [{
                        label: 'Total Holdings (tonnes)',
                        data: data,
                        borderColor: '#D4AF37',
                        backgroundColor: 'rgba(212, 175, 55, 0.1)',
                        fill: true,
                        tension: 0.3,
                        pointRadius: 0,
                        pointHoverRadius: 6,
                        pointHoverBackgroundColor: '#D4AF37',
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: '#1A1A1A',
                            borderColor: '#2A2A2A',
                            borderWidth: 1,
                            callbacks: {
                                label: (ctx) => `${ctx.parsed.y.toLocaleString()}t`
                            }
                        }
                    },
                    scales: {
                        y: {
                            grid: { color: '#2A2A2A' },
                            ticks: {
                                callback: (v) => `${(v/1000).toFixed(0)}k`
                            }
                        },
                        x: {
                            grid: { display: false },
                            ticks: {
                                maxTicksLimit: 10
                            }
                        }
                    }
                }
            });
        }

        function createHistoricalChart() {
            const ctx = document.getElementById('historicalChart').getContext('2d');
            const years = Object.keys(historicalData.annualNetPurchases);
            const purchasesData = years.map(y => historicalData.annualNetPurchases[y]);

            historicalChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: years,
                    datasets: [{
                        label: 'Net Purchases (tonnes)',
                        data: purchasesData,
                        backgroundColor: purchasesData.map(v => v >= 0 ? 'rgba(212, 175, 55, 0.8)' : 'rgba(239, 68, 68, 0.8)'),
                        borderColor: purchasesData.map(v => v >= 0 ? '#D4AF37' : '#EF4444'),
                        borderWidth: 1,
                        borderRadius: 2,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: '#1A1A1A',
                            borderColor: '#2A2A2A',
                            borderWidth: 1,
                            callbacks: {
                                label: (ctx) => {
                                    const year = ctx.label;
                                    const purchases = ctx.parsed.y;
                                    const holdings = historicalData.totalHoldings[year];
                                    const price = historicalData.goldPrice[year];
                                    return [
                                        `Net: ${purchases >= 0 ? '+' : ''}${purchases.toLocaleString()}t`,
                                        `Holdings: ${holdings.toLocaleString()}t`,
                                        `Gold: $${price}/oz`
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            grid: { color: '#2A2A2A' },
                            ticks: {
                                callback: (v) => `${v >= 0 ? '+' : ''}${v}t`
                            }
                        },
                        x: {
                            grid: { display: false },
                            ticks: { maxTicksLimit: 20 }
                        }
                    }
                }
            });
        }

        function updateHistoricalChart() {
            const period = parseInt(document.getElementById('historicalPeriod').value);
            const view = document.getElementById('historicalView').value;
            
            const allYears = Object.keys(historicalData.annualNetPurchases);
            const years = allYears.slice(-period);
            
            let data, label;
            if (view === 'annual') {
                data = years.map(y => historicalData.annualNetPurchases[y]);
                label = 'Net Purchases (tonnes)';
                historicalChartInstance.config.type = 'bar';
                historicalChartInstance.data.datasets[0].backgroundColor = data.map(v => v >= 0 ? 'rgba(212, 175, 55, 0.8)' : 'rgba(239, 68, 68, 0.8)');
                historicalChartInstance.data.datasets[0].borderColor = data.map(v => v >= 0 ? '#D4AF37' : '#EF4444');
                historicalChartInstance.options.scales.y.ticks.callback = (v) => `${v >= 0 ? '+' : ''}${v}t`;
            } else {
                data = years.map(y => historicalData.totalHoldings[y]);
                label = 'Total Holdings (tonnes)';
                historicalChartInstance.config.type = 'line';
                historicalChartInstance.data.datasets[0].backgroundColor = 'rgba(212, 175, 55, 0.1)';
                historicalChartInstance.data.datasets[0].borderColor = '#D4AF37';
                historicalChartInstance.data.datasets[0].fill = true;
                historicalChartInstance.data.datasets[0].tension = 0.3;
                historicalChartInstance.options.scales.y.ticks.callback = (v) => `${(v/1000).toFixed(0)}k`;
            }
            
            historicalChartInstance.data.labels = years;
            historicalChartInstance.data.datasets[0].data = data;
            historicalChartInstance.data.datasets[0].label = label;
            historicalChartInstance.update();
            
            populateHistoricalTable(period);
        }

        // ===========================================
        // TABLES
        // ===========================================
        function populateCountriesTable() {
            const tbody = document.getElementById('countriesTableBody');
            tbody.innerHTML = topHolders.map(h => `
                <tr>
                    <td>${h.rank}</td>
                    <td>
                        <div class="country-cell">
                            <div class="country-flag">${h.code}</div>
                            <span>${h.country}</span>
                        </div>
                    </td>
                    <td class="tonnes">${h.holdings.toLocaleString()}</td>
                    <td>${h.pctReserves}%</td>
                    <td class="${h.change2025 > 0 ? 'change-positive' : h.change2025 < 0 ? 'change-negative' : ''}">
                        ${h.change2025 > 0 ? '+' : ''}${h.change2025 || '‚Äî'}${h.change2025 ? 't' : ''}
                    </td>
                    <td>${h.lastReported}</td>
                </tr>
            `).join('');
        }

        function filterCountries() {
            const search = document.getElementById('countrySearch').value.toLowerCase();
            const filtered = topHolders.filter(h => 
                h.country.toLowerCase().includes(search) || 
                h.code.toLowerCase().includes(search)
            );
            
            const tbody = document.getElementById('countriesTableBody');
            tbody.innerHTML = filtered.map(h => `
                <tr>
                    <td>${h.rank}</td>
                    <td>
                        <div class="country-cell">
                            <div class="country-flag">${h.code}</div>
                            <span>${h.country}</span>
                        </div>
                    </td>
                    <td class="tonnes">${h.holdings.toLocaleString()}</td>
                    <td>${h.pctReserves}%</td>
                    <td class="${h.change2025 > 0 ? 'change-positive' : h.change2025 < 0 ? 'change-negative' : ''}">
                        ${h.change2025 > 0 ? '+' : ''}${h.change2025 || '‚Äî'}${h.change2025 ? 't' : ''}
                    </td>
                    <td>${h.lastReported}</td>
                </tr>
            `).join('');
        }

        function populateHistoricalTable(period = 40) {
            const allYears = Object.keys(historicalData.annualNetPurchases).reverse();
            const years = allYears.slice(0, period);
            
            const tbody = document.getElementById('historicalTableBody');
            tbody.innerHTML = years.map((year, i) => {
                const purchases = historicalData.annualNetPurchases[year];
                const holdings = historicalData.totalHoldings[year];
                const prevHoldings = historicalData.totalHoldings[parseInt(year) - 1] || holdings;
                const yoyChange = ((holdings - prevHoldings) / prevHoldings * 100).toFixed(1);
                const price = historicalData.goldPrice[year];
                
                return `
                    <tr>
                        <td>${year}</td>
                        <td class="${purchases >= 0 ? 'change-positive' : 'change-negative'}">
                            ${purchases >= 0 ? '+' : ''}${purchases.toLocaleString()}
                        </td>
                        <td class="tonnes">${holdings.toLocaleString()}</td>
                        <td class="${yoyChange >= 0 ? 'change-positive' : 'change-negative'}">
                            ${yoyChange >= 0 ? '+' : ''}${yoyChange}%
                        </td>
                        <td>$${price.toLocaleString()}</td>
                    </tr>
                `;
            }).join('');
        }

        // ===========================================
        // FILE UPLOAD
        // ===========================================
        function initializeDragDrop() {
            const dropZone = document.getElementById('dropZone');
            
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, preventDefaults, false);
            });
            
            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }
            
            ['dragenter', 'dragover'].forEach(eventName => {
                dropZone.addEventListener(eventName, () => dropZone.classList.add('dragover'));
            });
            
            ['dragleave', 'drop'].forEach(eventName => {
                dropZone.addEventListener(eventName, () => dropZone.classList.remove('dragover'));
            });
            
            dropZone.addEventListener('drop', handleDrop);
        }

        function handleDrop(e) {
            const files = e.dataTransfer.files;
            if (files.length) {
                handleFileUpload({ target: { files } });
            }
        }

        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const validTypes = ['text/csv', 'application/vnd.ms-excel', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'];
            
            if (!validTypes.includes(file.type) && !file.name.match(/\.(csv|xlsx|xls)$/)) {
                showToast('Please upload a CSV or Excel file', 'error');
                return;
            }
            
            // Simulate processing
            showToast(`Processing ${file.name}...`, 'success');
            
            // In a real implementation, you would parse the file here
            // using libraries like Papa Parse (CSV) or SheetJS (Excel)
            
            setTimeout(() => {
                const uploadsTable = document.getElementById('uploadsTableBody');
                const now = new Date().toLocaleDateString();
                uploadsTable.innerHTML = `
                    <tr>
                        <td>${now}</td>
                        <td>${file.name}</td>
                        <td>‚Äî</td>
                        <td><span style="color: var(--positive);">‚úì Uploaded</span></td>
                    </tr>
                ` + (uploadsTable.innerHTML.includes('No uploads') ? '' : uploadsTable.innerHTML);
                
                showToast(`${file.name} uploaded successfully!`, 'success');
            }, 1500);
        }

        function addManualEntry() {
            const country = document.getElementById('manualCountry').value;
            const date = document.getElementById('manualDate').value;
            const holdings = document.getElementById('manualHoldings').value;
            
            if (!country || !date || !holdings) {
                showToast('Please fill in all fields', 'error');
                return;
            }
            
            showToast(`Added entry for ${country}: ${holdings}t`, 'success');
            
            // Clear inputs
            document.getElementById('manualCountry').value = '';
            document.getElementById('manualDate').value = '';
            document.getElementById('manualHoldings').value = '';
        }

        // ===========================================
        // UTILITIES
        // ===========================================
        function updateLastUpdated() {
            const now = new Date();
            document.getElementById('lastUpdated').textContent = now.toLocaleDateString('en-US', { 
                month: 'short', 
                day: 'numeric',
                year: 'numeric'
            });
        }

        function refreshData() {
            showToast('Refreshing data...', 'success');
            // In production, this would fetch from APIs
            setTimeout(() => {
                updateLastUpdated();
                showToast('Data refreshed!', 'success');
            }, 1000);
        }

        function exportData() {
            const csvContent = generateCSV();
            downloadFile(csvContent, 'central_bank_gold_data.csv', 'text/csv');
            showToast('Data exported!', 'success');
        }

        function exportHistorical() {
            const years = Object.keys(historicalData.annualNetPurchases);
            let csv = 'Year,Net Purchases (t),Total Holdings (t),Gold Price (USD)\n';
            
            years.forEach(year => {
                csv += `${year},${historicalData.annualNetPurchases[year]},${historicalData.totalHoldings[year]},${historicalData.goldPrice[year]}\n`;
            });
            
            downloadFile(csv, 'cb_gold_historical_1985_2024.csv', 'text/csv');
            showToast('Historical data exported!', 'success');
        }

        function generateCSV() {
            let csv = 'Rank,Country,Holdings (t),% of Reserves,2024 Change,Last Reported\n';
            topHolders.forEach(h => {
                csv += `${h.rank},${h.country},${h.holdings},${h.pctReserves},${h.change2024},${h.lastReported}\n`;
            });
            return csv;
        }

        function downloadFile(content, filename, type) {
            const blob = new Blob([content], { type });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            
            toast.className = `toast ${type}`;
            toastMessage.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
    </script>
</body>
</html>
